<!DOCTYPE html><html lang="en" data-astro-cid-sckkx6r4> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Lucas Sobral" href="https://lucasbral.github.io/rss.xml"><meta name="generator" content="Astro v5.16.14"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://lucasbral.github.io/blog/2024-11-03/2024-11-03-fut-scrap/"><!-- Primary Meta Tags --><title>Scrapping football data from optaplayerstats.statsperform.com</title><meta name="title" content="Scrapping football data from optaplayerstats.statsperform.com"><meta name="description" content="This tutorial will demonstrate how to develop a Python program using Selenium and BeautifulSoup to extract data from the Opta Player Stats statistics platform."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://lucasbral.github.io/blog/2024-11-03/2024-11-03-fut-scrap/"><meta property="og:title" content="Scrapping football data from optaplayerstats.statsperform.com"><meta property="og:description" content="This tutorial will demonstrate how to develop a Python program using Selenium and BeautifulSoup to extract data from the Opta Player Stats statistics platform."><meta property="og:image" content="https://lucasbral.github.io/assets/img/2024-11-03/f.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://lucasbral.github.io/blog/2024-11-03/2024-11-03-fut-scrap/"><meta property="twitter:title" content="Scrapping football data from optaplayerstats.statsperform.com"><meta property="twitter:description" content="This tutorial will demonstrate how to develop a Python program using Selenium and BeautifulSoup to extract data from the Opta Player Stats statistics platform."><meta property="twitter:image" content="https://lucasbral.github.io/assets/img/2024-11-03/f.png"><!-- GoatCounter Analytics --><script async src="https://gc.zgo.at/count.js" data-goatcounter="https://lucasbral.goatcounter.com/count"></script><script>
			// Blocking script to prevent flash of unstyled content (FOUC)
			const theme = (() => {
				if (
					typeof localStorage !== "undefined" &&
					localStorage.getItem("theme")
				) {
					return localStorage.getItem("theme");
				}
				if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
					return "dark";
				}
				return "light";
			})();

			if (theme === "dark") {
				document.documentElement.classList.add("dark");
			} else {
				document.documentElement.classList.remove("dark");
			}
			// Ensure localStorage is sync'd
			window.localStorage.setItem("theme", theme);
		</script><link rel="stylesheet" href="/_astro/_slug_.DWIzDjJY.css">
<link rel="stylesheet" href="/_astro/_slug_.dnqBqIgo.css">
<style>main[data-astro-cid-sckkx6r4].full-width{max-width:100%!important;padding:0!important}
.view-counter[data-astro-cid-e75zxctz]{color:var(--gray);font-size:.9em;display:inline-flex;align-items:center;gap:.3em}.loading[data-astro-cid-e75zxctz]{opacity:.5}.blog-page-layout{display:grid;grid-template-columns:280px 1fr 280px;gap:2rem;width:100%;max-width:1400px;margin:0 auto;padding:2rem;align-items:start}.blog-page-layout .left-sidebar{position:sticky;top:2rem;height:fit-content;border-right:1px solid var(--color-border);padding-right:1.5rem}.blog-page-layout .right-sidebar-container{position:sticky;top:2rem;height:fit-content;border-left:1px solid var(--color-border);padding-left:1.5rem}.blog-page-layout .main-content{width:100%;min-width:0}@media(max-width:1200px){.blog-page-layout{grid-template-columns:280px 1fr;max-width:1000px}.blog-page-layout .right-sidebar-container{display:none}.blog-page-layout .left-sidebar{padding-right:1.5rem}}@media(max-width:900px){.blog-page-layout{display:block;padding:1rem}.blog-page-layout .left-sidebar{position:fixed!important;top:0!important;height:100vh!important;max-height:100vh!important;z-index:1000}}.hero-image{width:100%;margin-bottom:2rem}.hero-image img{display:block;margin:0 auto;border-radius:12px;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;width:100%;height:auto;max-height:400px;object-fit:cover}.prose{width:100%;max-width:100%;margin:auto}.title{margin-bottom:2rem;text-align:center;line-height:1}.date{margin-bottom:.5em;color:var(--color-secondary);display:flex;align-items:center;justify-content:center;gap:.5rem;flex-wrap:wrap}.date-separator{color:var(--gray-light)}.last-updated-on{font-style:italic}hr{border:0;border-top:1px solid var(--color-border);margin:2rem 0}
.right-sidebar[data-astro-cid-zujyv34g]{width:100%;font-size:.9em}.sidebar-section[data-astro-cid-zujyv34g]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--color-border)}.sidebar-section[data-astro-cid-zujyv34g] h3[data-astro-cid-zujyv34g]{margin-bottom:1rem;font-size:1rem;text-transform:uppercase;letter-spacing:1px;color:var(--gray);font-weight:600}.recent-list[data-astro-cid-zujyv34g]{list-style:none;padding:0;margin:0}.recent-list[data-astro-cid-zujyv34g] li[data-astro-cid-zujyv34g]{margin-bottom:1rem}.recent-link[data-astro-cid-zujyv34g]{display:flex;flex-direction:column;text-decoration:none;color:var(--color-text);transition:color .2s}.recent-link[data-astro-cid-zujyv34g]:hover .recent-title[data-astro-cid-zujyv34g]{color:var(--accent)}.recent-title[data-astro-cid-zujyv34g]{font-weight:500;line-height:1.3;margin-bottom:.2rem}.recent-date[data-astro-cid-zujyv34g]{font-size:.8em;color:var(--gray)}.tag-cloud[data-astro-cid-zujyv34g]{display:flex;flex-wrap:wrap;gap:.5rem}.tag-item[data-astro-cid-zujyv34g]{background:var(--gray-light);padding:.2rem .6rem;border-radius:4px;text-decoration:none;color:var(--gray-dark);font-size:.85em;transition:all .2s}.tag-item[data-astro-cid-zujyv34g]:hover{background:var(--accent);color:#fff}
</style></head> <body data-astro-cid-sckkx6r4> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <button id="menu-toggle" aria-label="Toggle Menu" class="menu-toggle" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-3ef6ksr2> <line x1="3" y1="12" x2="21" y2="12" data-astro-cid-3ef6ksr2></line> <line x1="3" y1="6" x2="21" y2="6" data-astro-cid-3ef6ksr2></line> <line x1="3" y1="18" x2="21" y2="18" data-astro-cid-3ef6ksr2></line> </svg> </button> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>Lucas Sobral</a></h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a>  <a href="/about" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> About </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://github.com/lucasbral" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="24" height="24" fill="currentColor" data-astro-cid-3ef6ksr2> <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path> </svg> </a> <a href="https://www.linkedin.com/in/lucasbral" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>LinkedIn</span> <svg viewBox="0 0 24 24" aria-hidden="true" width="24" height="24" fill="currentColor" data-astro-cid-3ef6ksr2> <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" data-astro-cid-3ef6ksr2></path> </svg> </a> <div class="search-container" data-astro-cid-otpdt6jm> <button id="search-btn" aria-label="Open search" data-astro-cid-otpdt6jm> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="8" data-astro-cid-otpdt6jm></circle> <line x1="21" y1="21" x2="16.65" y2="16.65" data-astro-cid-otpdt6jm></line> </svg> </button> <div id="search-modal" class="hidden" data-astro-cid-otpdt6jm> <div class="modal-content" data-astro-cid-otpdt6jm> <div class="search-header" data-astro-cid-otpdt6jm> <input type="text" id="search-input" placeholder="Search posts..." autofocus data-astro-cid-otpdt6jm> <button id="close-search" aria-label="Close search" data-astro-cid-otpdt6jm> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm> <line x1="18" y1="6" x2="6" y2="18" data-astro-cid-otpdt6jm></line> <line x1="6" y1="6" x2="18" y2="18" data-astro-cid-otpdt6jm></line> </svg> </button> </div> <ul id="search-results" data-astro-cid-otpdt6jm></ul> </div> </div> </div>  <script lang="ts">
    document.addEventListener("DOMContentLoaded", () => {
        const searchBtn = document.getElementById("search-btn");
        const searchModal = document.getElementById("search-modal");
        const closeBtn = document.getElementById("close-search");
        const searchInput = document.getElementById("search-input");
        const searchResults = document.getElementById("search-results");

        let posts = [];

        // Fetch posts on hover or focus to preload
        const fetchPosts = async () => {
            if (posts.length > 0) return;
            try {
                const res = await fetch("/search.json");
                posts = await res.json();
            } catch (err) {
                console.error("Error fetching search index:", err);
            }
        };

        searchBtn?.addEventListener("mouseenter", fetchPosts);
        searchBtn?.addEventListener("focus", fetchPosts);

        const openSearch = async () => {
            await fetchPosts();
            searchModal?.classList.remove("hidden");
            // Force reflow
            searchModal?.offsetHeight;
            searchModal?.classList.add("visible");
            searchInput?.focus();
            document.body.style.overflow = "hidden";
        };

        const closeSearch = () => {
            searchModal?.classList.remove("visible");
            setTimeout(() => {
                searchModal?.classList.add("hidden");
            }, 200);
            document.body.style.overflow = "";
            if (searchInput instanceof HTMLInputElement) searchInput.value = "";
            if (searchResults) searchResults.innerHTML = "";
        };

        searchBtn?.addEventListener("click", openSearch);
        closeBtn?.addEventListener("click", closeSearch);

        // Close on backdrop click
        searchModal?.addEventListener("click", (e) => {
            if (e.target === searchModal) closeSearch();
        });

        // Close on Escape key
        document.addEventListener("keydown", (e) => {
            if (
                e.key === "Escape" &&
                searchModal?.classList.contains("visible")
            ) {
                closeSearch();
            }
        });

        // Search logic
        searchInput?.addEventListener("input", (e) => {
            if (!(searchInput instanceof HTMLInputElement)) return;
            const query = searchInput.value.toLowerCase();

            if (!query) {
                if (searchResults) searchResults.innerHTML = "";
                return;
            }

            const filtered = posts.filter(
                (post) =>
                    post.title.toLowerCase().includes(query) ||
                    (post.description &&
                        post.description.toLowerCase().includes(query)),
            );

            if (searchResults) {
                if (filtered.length === 0) {
                    searchResults.innerHTML =
                        '<li class="no-results">No posts found</li>';
                } else {
                    searchResults.innerHTML = filtered
                        .map(
                            (post) => `
                        <li class="search-result-item">
                            <a href="${post.slug}" class="search-result-link">
                                <span class="result-title">${post.title}</span>
                                <span class="result-desc">${post.description}</span>
                            </a>
                        </li>
                    `,
                        )
                        .join("");
                }
            }
        });
    });
</script> <button id="theme-toggle" aria-label="Toggle theme" data-astro-cid-x3pjskd3> <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-x3pjskd3> <circle cx="12" cy="12" r="5" data-astro-cid-x3pjskd3></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-x3pjskd3></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-x3pjskd3></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-x3pjskd3></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-x3pjskd3></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-x3pjskd3></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-x3pjskd3></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-x3pjskd3></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-x3pjskd3></line> </svg> <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-x3pjskd3> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-x3pjskd3></path> </svg> </button>  <script>
	// Theme toggle handler
	const handleToggleClick = () => {
		const element = document.documentElement;
		element.classList.toggle("dark");

		const isDark = element.classList.contains("dark");
		localStorage.setItem("theme", isDark ? "dark" : "light");
	};

	document
		.getElementById("theme-toggle")
		.addEventListener("click", handleToggleClick);
</script> </div> </nav> </header>  <script>
	// Robust Mobile Menu Toggle
	document.addEventListener("DOMContentLoaded", () => {
		const menuToggle = document.getElementById("menu-toggle");
		const body = document.body;

		if (menuToggle) {
			menuToggle.addEventListener("click", (e) => {
				e.stopPropagation();
				e.preventDefault(); // Prevent any default button behavior
				body.classList.toggle("show-sidebar");
				console.log(
					"Menu toggled",
					body.classList.contains("show-sidebar"),
				);
			});
		}

		// Close on Outside Click
		document.addEventListener("click", (e) => {
			const sidebar = document.querySelector(".sidebar-container");
			const toggle = document.getElementById("menu-toggle");

			if (body.classList.contains("show-sidebar")) {
				// If click target is NOT in sidebar AND NOT the toggle button
				if (
					sidebar &&
					!sidebar.contains(e.target) &&
					toggle &&
					!toggle.contains(e.target)
				) {
					body.classList.remove("show-sidebar");
				}
			}
		});
	});
</script>  <main class="full-width" data-astro-cid-sckkx6r4>  <div class="blog-page-layout"> <aside class="left-sidebar sidebar-container"> <aside class="sidebar" data-astro-cid-ssfzsv2f> <div class="mobile-header" data-astro-cid-ssfzsv2f> <h2 class="sidebar-title" data-astro-cid-ssfzsv2f><!-- Menu title removed as requested --></h2> <button id="sidebar-close" aria-label="Close Menu" data-astro-cid-ssfzsv2f> ✕ </button> </div> <div class="mobile-toggle" data-astro-cid-ssfzsv2f> <!-- Kept for backward compatibility if needed, but likely redundant now --> <button id="sidebar-toggle" aria-label="Toggle Menu" style="display: none;" data-astro-cid-ssfzsv2f>
☰ Menu
</button> </div> <div class="sidebar-content" id="sidebar-content" data-astro-cid-ssfzsv2f> <div class="profile-section" data-astro-cid-ssfzsv2f> <div class="avatar-container" data-astro-cid-ssfzsv2f> <img src="https://avatars.githubusercontent.com/u/27840392?v=4" alt="Lucas Sobral" class="avatar" data-astro-cid-ssfzsv2f> </div> <h3 class="profile-name" data-astro-cid-ssfzsv2f>Lucas Sobral</h3> <p class="profile-bio" data-astro-cid-ssfzsv2f>Simplifying technology, one line of code at a time.</p> </div> <!-- Mobile Navigation Links --> <!-- Mobile Only: About Link --> <div class="sidebar-section mobile-only-section" data-astro-cid-ssfzsv2f> <h3 data-astro-cid-ssfzsv2f> <a href="/about" class="sidebar-link" data-astro-cid-ssfzsv2f>About</a> </h3> </div> <!-- Categories: Desktop Only --> <div class="sidebar-section categories-section" data-astro-cid-ssfzsv2f> <h3 data-astro-cid-ssfzsv2f> <a href="/categories" class="sidebar-link" data-astro-cid-ssfzsv2f>Categories</a> </h3> </div> <!-- Archives: Desktop Only --> <div class="sidebar-section archives-section" data-astro-cid-ssfzsv2f> <h3 data-astro-cid-ssfzsv2f> <a href="/archives" class="sidebar-link" data-astro-cid-ssfzsv2f>Archives</a> </h3> </div> <div class="sidebar-section tags-section" data-astro-cid-ssfzsv2f> <h3 data-astro-cid-ssfzsv2f> <a href="/tags" class="sidebar-link" data-astro-cid-ssfzsv2f>Tags</a> </h3> </div> </div>  <script>
        document.addEventListener("DOMContentLoaded", () => {
            const closeBtn = document.getElementById("sidebar-close");
            closeBtn?.addEventListener("click", () => {
                document.body.classList.remove("show-sidebar");
            });
        });
    </script> </aside> </aside> <article class="fade-in main-content"> <div class="hero-image"> <img width="1020" height="510" src="/assets/img/2024-11-03/f.png" alt=""> </div> <div class="prose"> <div class="title"> <div class="date"> <time datetime="2024-11-03T06:10:00.000Z">Nov 3, 2024</time> <span class="date-separator">•</span>  <div class="view-count"> <span class="view-counter" data-astro-cid-e75zxctz> <span id="pageviews" data-astro-cid-e75zxctz> <span class="loading" data-astro-cid-e75zxctz>...</span> </span>
views
</span> <script type="module">document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("pageviews");if(n!==null){const t=location.pathname.replace(/\/$/,""),o=`https://lucasbral.goatcounter.com/counter/${encodeURIComponent(t)}.json`;fetch(o).then(e=>e.json()).then(e=>{const c=e.count.replace(/\D/g,"");n.innerText=new Intl.NumberFormat().format(c)}).catch(e=>{console.error("Error fetching page views:",e),n.innerText="0"})}});</script>  </div> </div> <h1>Scrapping football data from optaplayerstats.statsperform.com</h1> <hr> </div>  <h2 id="motivation">Motivation</h2>
<p>The motivation for this tutorial comes from a close friend of mine, who is a data scientist and asked for my help with one of his personal projects. His goal is to build a predictive model to estimate the minute of play when the first yellow card will be issued in soccer matches. For this, the chosen football statistics platform is <a href="https://optaplayerstats.statsperform.com">Opta Player Stats</a>, and the selected league is the Brazilian Série A.</p>
<h2 id="studying-the-website-and-defining-variables">Studying the Website and Defining Variables</h2>
<p>On the website, there is a specific link that lists all matches of the year for a given football championship. In the case of the link <a href="https://optaplayerstats.statsperform.com/en_GB/soccer/brasileir%C3%A3o-s%C3%A9rie-a-2023/czjx4rda7swlzql5d1cq90r8/opta-player-stats">Opta Player Stats</a> - Brasileirão Série A 2023, it provides all the matches of the 2023 Brazilian Championship. Each game has its own specific link that displays detailed information for each individual match, and this will be the first piece of information we need to collect.</p>
<p><img src="/assets/img/2024-11-03/1.png" alt="desktop View">
<em>View of the site</em></p>
<p>Using the Firefox browser and pressing the F12 key to access the HTML file of the page, you can view all the information. In the path shown in the image below, we find the class that defines all the matches.</p>
<p><img src="/assets/img/2024-11-03/2.png" alt="desktop View">
<em>Classes on the website that refer to matches</em></p>
<blockquote>
<p>Note that the classes starting with <code>Opta-fixture Opta-Match</code> are responsible for providing information for each game in the championship.
{: .prompt-tip }</p>
</blockquote>
<p>With this information, we can start writing our code to extract these data.</p>
<h2 id="extracting-matchs-links">Extracting Matchs Links</h2>
<p>The code below reads the HTML from the link containing the championship matches and uses BeautifulSoup to filter the Opta-fixture Opta-Match class, returning only the href parameter of each one.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> numpy </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> np</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pandas </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> pd</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> requests</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> bs4 </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> BeautifulSoup</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> webdriver</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.firefox.options </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># URL of the championship</span></span>
<span class="line"><span style="color:#E1E4E8">url </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "https://optaplayerstats.statsperform.com/pt_BR/soccer/brasileir%C3%A3o-s%C3%A9rie-a-2023/czjx4rda7swlzql5d1cq90r8/opta-player-stats"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Set up Selenium with headless Firefox</span></span>
<span class="line"><span style="color:#E1E4E8">option </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Options()</span></span>
<span class="line"><span style="color:#E1E4E8">option.headless </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> True</span></span>
<span class="line"><span style="color:#E1E4E8">driver </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> webdriver.Firefox(</span><span style="color:#FFAB70">options</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">option)</span></span>
<span class="line"><span style="color:#6A737D"># Load the page</span></span>
<span class="line"><span style="color:#E1E4E8">driver.get(url)</span></span>
<span class="line"><span style="color:#E1E4E8">time.sleep(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">html </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> driver.page_source</span></span>
<span class="line"><span style="color:#6A737D"># Parse the HTML with BeautifulSoup</span></span>
<span class="line"><span style="color:#E1E4E8">soup </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> BeautifulSoup(html, </span><span style="color:#9ECBFF">'html.parser'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D"># Find the table with the class 'Opta-Crested'</span></span>
<span class="line"><span style="color:#E1E4E8">table </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find(</span><span style="color:#9ECBFF">'table'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Crested'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D"># Close the driver</span></span>
<span class="line"><span style="color:#E1E4E8">driver.quit()</span></span>
<span class="line"><span style="color:#6A737D"># Extract the href attributes of the links</span></span>
<span class="line"><span style="color:#E1E4E8">part </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [link[</span><span style="color:#9ECBFF">'href'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> link </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> table.find_all(</span><span style="color:#9ECBFF">'a'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-MatchLink Opta-Ext'</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Total Matches:"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(part))</span></span></code></pre>
<h2 id="match-data">Match Data</h2>
<p>Now that we have the links for each match, it’s necessary to extract the data from each match that is relevant for this study. The variables we will use are essentially those shown in the figure below.</p>
<p><img src="/assets/img/2024-11-03/3.png" alt="desktop View">
<em>Match info</em></p>
<p>On the game timeline, there are symbols indicating yellow cards, goals, and own goals. When you hover the mouse over these symbols, the player responsible for the event and the minute it occurred in the game are displayed.</p>
<h2 id="extracting-match-data">Extracting Match Data</h2>
<p>Now that we have the information to be extracted from the site, we can develop the code needed to accomplish this task.</p>
<h3 id="extracting-teams-infos">Extracting Teams Infos</h3>
<p>In this section, we will extract the data for the home team, away team, and the goals for each side. In the image below, you can see that the entire HTML block containing this information is within a <code>&#x3C;table></code> with the class <code>Opta-MatchHeader Opta-MatchHeader-Crested</code>.</p>
<p><img src="/assets/img/2024-11-03/4.png" alt="desktop View">
<em>Html that show teams infos</em></p>
<p>We can then use BeautifulSoup to extract the information contained within these specific classes.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> numpy </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> np</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pandas </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> pd</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> requests</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> bs4 </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> BeautifulSoup</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> webdriver</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.firefox.options </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># URL of the championship</span></span>
<span class="line"><span style="color:#E1E4E8">url </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "https://optaplayerstats.statsperform.com/pt_BR/soccer/brasileir%C3%A3o-s%C3%A9rie-a-2023/czjx4rda7swlzql5d1cq90r8/match/view/dykfkagvqqndkwt56ph8meqz8/match-summary"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Set up Selenium with headless Firefox</span></span>
<span class="line"><span style="color:#E1E4E8">option </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Options()</span></span>
<span class="line"><span style="color:#E1E4E8">option.headless </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> True</span></span>
<span class="line"><span style="color:#E1E4E8">driver </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> webdriver.Firefox(</span><span style="color:#FFAB70">options</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">option)</span></span>
<span class="line"><span style="color:#6A737D"># Load the page</span></span>
<span class="line"><span style="color:#E1E4E8">driver.get(url)</span></span>
<span class="line"><span style="color:#E1E4E8">time.sleep(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">html </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> driver.page_source</span></span>
<span class="line"><span style="color:#6A737D"># Parse the HTML with BeautifulSoup</span></span>
<span class="line"><span style="color:#E1E4E8">soup </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> BeautifulSoup(html, </span><span style="color:#9ECBFF">'html.parser'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D"># Find the table with the class 'Opta-Crested'</span></span>
<span class="line"><span style="color:#E1E4E8">table </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find(</span><span style="color:#9ECBFF">'table'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Crested'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D"># Close the driver</span></span>
<span class="line"><span style="color:#E1E4E8">driver.quit()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">home_teams </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'td'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-Team Opta-Home Opta-Team-Left Opta-TeamName'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">away_teams </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'td'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-Team Opta-Away Opta-Team-Right Opta-TeamName'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">home_team_names </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [team.text.strip() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> team </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> home_teams]</span></span>
<span class="line"><span style="color:#E1E4E8">away_team_names </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [team.text.strip() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> team </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> away_teams]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">match_widget_container </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find(</span><span style="color:#9ECBFF">'div'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'match-widget-container'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">home_scores </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> match_widget_container.find_all(</span><span style="color:#9ECBFF">'td'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-Score Opta-Home Opta-Team'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">away_scores </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> match_widget_container.find_all(</span><span style="color:#9ECBFF">'td'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-Score Opta-Away Opta-Team'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Extraia os placares dos times</span></span>
<span class="line"><span style="color:#E1E4E8">home_team_score </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [score.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Team-Score'</span><span style="color:#E1E4E8">).text.strip() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> score </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> home_scores]</span></span>
<span class="line"><span style="color:#E1E4E8">away_team_score </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [score.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Team-Score'</span><span style="color:#E1E4E8">).text.strip() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> score </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> away_scores]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(home_team_names)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(away_team_names)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(home_team_score)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(away_team_score)</span></span></code></pre>
<p>With this, our code is now able to retrieve the team information and the game score.</p>
<h3 id="extracting-matchs-infos">Extracting Matchs Infos</h3>
<p>Now we need to develop the part of the code that will retrieve information about the match stadium, attendance, and the referee who officiated the game.</p>
<p><img src="/assets/img/2024-11-03/5.png" alt="desktop View">
<em>Html that show match data</em></p>
<blockquote>
<p>Note that the class responsible for providing this information is <code>Opta-Matchdata</code>. Therefore, we use BeautifulSoup to extract it.
{: .prompt-tip }</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D">#keep the same libraries and driver configuration from the previous code.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">match_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'div'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Matchdata'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">match_data_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [data.text.strip() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> data </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> match_data]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">est </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> public </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ref </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "No data"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> match_data:</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> data </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> match_data:</span></span>
<span class="line"><span style="color:#E1E4E8">        dls </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> data.find_all(</span><span style="color:#9ECBFF">'dl'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> dl </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> dls:</span></span>
<span class="line"><span style="color:#E1E4E8">            dt </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dl.find(</span><span style="color:#9ECBFF">'dt'</span><span style="color:#E1E4E8">).text.strip()</span></span>
<span class="line"><span style="color:#E1E4E8">            dd </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dl.find(</span><span style="color:#9ECBFF">'dd'</span><span style="color:#E1E4E8">).text.strip()</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> dt </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> 'Est'</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                est </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dd</span></span>
<span class="line"><span style="color:#F97583">            elif</span><span style="color:#E1E4E8"> dt </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> 'P'</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                public </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dd</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                ref </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(est)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(public)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ref)</span></span></code></pre>
<blockquote>
<p>This part of the code was configured in my native language, Brazilian Portuguese. For other languages, simply change the text that appears before each information topic. For example, “Est” becomes “Venue” in English, and so on.
{: .prompt-danger }</p>
</blockquote>
<h3 id="extracting-cards-infos">Extracting Cards Infos</h3>
<p>To extract information about cards during the game, we will use the data contained in the match timeline. The HTML divides the timeline into two parts: one for the home team, defined as <code>Opta-Events Opta-Home</code>, and another for the away team, as <code>Opta-Events Opta-Away</code>.</p>
<p>Knowing this, we will extract these two pieces of information separately.</p>
<p>Another important detail is that each event occurring within the timeline has a specific numbering, which starts with <code>opta-MatchEvent Opta...</code>, as shown in the figure below.</p>
<p>Additionally, the site defines three types of cards: yellow, red, and second yellow.</p>
<p>This classification is determined by the type of icon displayed in the timeline. There are three types of classes for these icons:</p>
<ul>
<li><code>Opta-Icon Opta-IconYellow</code> for yellow cards</li>
<li><code>Opta-Icon Opta-IconRed</code> for red cards</li>
<li><code>Opta-Icon Opta-IconDouble</code> for second yellow cards</li>
</ul>
<p><img src="/assets/img/2024-11-03/6.png" alt="desktop View">
<em>Html that show timeline data</em></p>
<p>With this information, we can develop the code below:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D">#keep the same libraries and driver configuration from the previous code.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">home_events_list </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'ul'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Events Opta-Home'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">events_home </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> home_events </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> home_events_list:</span></span>
<span class="line"><span style="color:#E1E4E8">    events_home.extend(home_events.find_all(</span><span style="color:#9ECBFF">'li'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-MatchEvent Opta-Event-Type'</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">yellow_cards_home </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">red_cards_home </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">sec_card_home </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> event </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> events_home:</span></span>
<span class="line"><span style="color:#E1E4E8">    minute </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Event-Min'</span><span style="color:#E1E4E8">).text.strip().replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200e</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200f</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconYellow'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        yellow_cards_home.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconRed'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        red_cards_home.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconDouble'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        sec_card_home.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">away_events_list </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'ul'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Events Opta-Away'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">#events AWAY</span></span>
<span class="line"><span style="color:#E1E4E8">events_away </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> away_events </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> away_events_list:</span></span>
<span class="line"><span style="color:#E1E4E8">    events_away.extend(away_events.find_all(</span><span style="color:#9ECBFF">'li'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-MatchEvent Opta-Event-Type'</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">yellow_cards_away </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">red_cards_away </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">sec_card_away </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> event </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> events_away:</span></span>
<span class="line"><span style="color:#E1E4E8">    minute </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Event-Min'</span><span style="color:#E1E4E8">).text.strip().replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200e</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200f</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconYellow'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        yellow_cards_away.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconRed'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        red_cards_away.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconDouble'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        sec_card_away.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute})</span></span></code></pre>
<p>With this code, we then create six variables that store a JSON array with information about the players who received the card and the specific minute, as shown in the table below:</p>

































<table><thead><tr><th>var</th><th>Description</th></tr></thead><tbody><tr><td><strong>yellow_cards_home</strong></td><td>A JSON array containing information about yellow cards received by players of the home team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who received the yellow card. <br> - <strong>minute</strong>: The minute when the yellow card was given.</td></tr><tr><td><strong>red_cards_home</strong></td><td>A JSON array containing information about red cards received by players of the home team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who received the red card. <br> - <strong>minute</strong>: The minute when the red card was given.</td></tr><tr><td><strong>yellow_cards_away</strong></td><td>A JSON array containing information about yellow cards received by players of the away team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who received the yellow card. <br> - <strong>minute</strong>: The minute when the yellow card was given.</td></tr><tr><td><strong>red_cards_away</strong></td><td>A JSON array containing information about red cards received by players of the away team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who received the red card. <br> - <strong>minute</strong>: The minute when the red card was given.</td></tr><tr><td><strong>sec_card_home</strong></td><td>A JSON array containing information about second yellow cards received by players of the home team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who received the second yellow card. <br> - <strong>minute</strong>: The minute when the second yellow card was given.</td></tr><tr><td><strong>sec_card_away</strong></td><td>A JSON array containing information about second yellow cards received by players of the away team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who received the second yellow card. <br> - <strong>minute</strong>: The minute when the second yellow card was given.</td></tr></tbody></table>
<h3 id="extracting-goals-infos">Extracting Goals Infos</h3>
<p>The process for extracting goal information is quite similar to that of cards. The difference is that we will use the following classes:</p>
<ul>
<li><code>Opta-Icon Opta-IconGoal</code> for a normal goal</li>
<li><code>Opta-Icon Opta-IconOwn</code> for an own goal</li>
<li><code>Opta-Icon Opta-IconPenGoal</code> for a penalty goal</li>
</ul>
<p>The code then looks like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D">#keep the same libraries and driver configuration from the previous code.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">home_events_list </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'ul'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Events Opta-Home'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">events_home </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> home_events </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> home_events_list:</span></span>
<span class="line"><span style="color:#E1E4E8">    events_home.extend(home_events.find_all(</span><span style="color:#9ECBFF">'li'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-MatchEvent Opta-Event-Type'</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">gols_home </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> event </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> events_home:</span></span>
<span class="line"><span style="color:#E1E4E8">    minute </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Event-Min'</span><span style="color:#E1E4E8">).text.strip().replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200e</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200f</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconGoal'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        gols_home.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute, </span><span style="color:#9ECBFF">'cont'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'penal'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconOwn'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        gols_home.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute, </span><span style="color:#9ECBFF">'cont'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'penal'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconPenGoal'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        gols_home.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute, </span><span style="color:#9ECBFF">'cont'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'penal'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">away_events_list </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find_all(</span><span style="color:#9ECBFF">'ul'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Events Opta-Away'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">#events AWAY</span></span>
<span class="line"><span style="color:#E1E4E8">events_away </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> away_events </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> away_events_list:</span></span>
<span class="line"><span style="color:#E1E4E8">    events_away.extend(away_events.find_all(</span><span style="color:#9ECBFF">'li'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> x: x </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> x.startswith(</span><span style="color:#9ECBFF">'Opta-MatchEvent Opta-Event-Type'</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">gols_away </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> event </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> events_away:</span></span>
<span class="line"><span style="color:#E1E4E8">    minute </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'span'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Event-Min'</span><span style="color:#E1E4E8">).text.strip().replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200e</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\u200f</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconGoal'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        gols_away.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute, </span><span style="color:#9ECBFF">'cont'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'penal'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconOwn'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        gols_away.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute, </span><span style="color:#9ECBFF">'cont'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'penal'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Opta-Icon Opta-IconPenGoal'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        player_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.find(</span><span style="color:#9ECBFF">'img'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> player_img </span><span style="color:#F97583">and</span><span style="color:#9ECBFF"> 'alt'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> player_img.attrs:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> player_img[</span><span style="color:#9ECBFF">'alt'</span><span style="color:#E1E4E8">].strip()</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            player </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "undefined"</span></span>
<span class="line"><span style="color:#E1E4E8">        gols_away.append({</span><span style="color:#9ECBFF">'player'</span><span style="color:#E1E4E8">: player, </span><span style="color:#9ECBFF">'minute'</span><span style="color:#E1E4E8">: minute, </span><span style="color:#9ECBFF">'cont'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'penal'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">})</span></span></code></pre>
<p>With this code, we then create two variables that store the goals of the home team and the away team in the format below:</p>

















<table><thead><tr><th>var</th><th>Description</th></tr></thead><tbody><tr><td><strong>gols_home</strong></td><td>A JSON array containing information about goals scored by players of the home team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who scored the goal. <br> - <strong>minute</strong>: The minute when the goal was scored. <br> - <strong>cont</strong>: Indicates if the goal was an own goal (1 for own goal, 0 otherwise). <br> - <strong>penal</strong>: Indicates if the goal was a penalty (1 for penalty, 0 otherwise).</td></tr><tr><td><strong>gols_away</strong></td><td>A JSON array containing information about goals scored by players of the away team. Each object in the array includes: <br> - <strong>player</strong>: The name of the player who scored the goal. <br> - <strong>minute</strong>: The minute when the goal was scored. <br> - <strong>cont</strong>: Indicates if the goal was an own goal (1 for own goal, 0 otherwise). <br> - <strong>penal</strong>: Indicates if the goal was a penalty (1 for penalty, 0 otherwise).</td></tr></tbody></table>
<h2 id="conclusions">Conclusions</h2>
<p>With the information provided here, it is possible to build a program that extracts football match information from any championship available at optaplayerstats.statsperform.com. The link to this complete project is on <a href="https://github.com/lucasbral/fut_scrap/tree/main">GitHub</a>.</p>
<p>By using this program, it was possible to create a dataset with the data from all matches of the Brasileirão from 2020 to 2023, which can be found at this link on <a href="https://www.kaggle.com/datasets/lucasbral/brasileirao-cartoes-20-23/">Kaggle</a>.</p>  </div> </article> <!-- Right Sidebar (Desktop Only) --> <aside class="right-sidebar-container"> <aside class="right-sidebar" data-astro-cid-zujyv34g> <div class="sidebar-section" data-astro-cid-zujyv34g> <h3 data-astro-cid-zujyv34g>Recently Updated</h3> <ul class="recent-list" data-astro-cid-zujyv34g> <li data-astro-cid-zujyv34g> <a href="/blog/2025-06-27/2025-06-27-streamlit-duckdb/" class="recent-link" data-astro-cid-zujyv34g> <span class="recent-title" data-astro-cid-zujyv34g>Building a High-Performance and Interactive Data Application with Streamlit and DuckDB</span> <span class="recent-date" data-astro-cid-zujyv34g> <time datetime="2025-06-26T16:00:00.000Z">Jun 26, 2025</time> </span> </a> </li><li data-astro-cid-zujyv34g> <a href="/blog/2025-02-25/2025-02-25-aws-pipeline/" class="recent-link" data-astro-cid-zujyv34g> <span class="recent-title" data-astro-cid-zujyv34g>Creating A Small Data Pipeline Using Dynamodb And Lambda Functions On Aws</span> <span class="recent-date" data-astro-cid-zujyv34g> <time datetime="2025-02-24T16:00:00.000Z">Feb 24, 2025</time> </span> </a> </li><li data-astro-cid-zujyv34g> <a href="/blog/2024-11-29/2024-11-29-spotify/" class="recent-link" data-astro-cid-zujyv34g> <span class="recent-title" data-astro-cid-zujyv34g>Obtaining the Most Listened Tracks on Spotify with Apache Airflow</span> <span class="recent-date" data-astro-cid-zujyv34g> <time datetime="2024-11-28T16:00:00.000Z">Nov 28, 2024</time> </span> </a> </li><li data-astro-cid-zujyv34g> <a href="/blog/2024-11-11/2024-11-11-airflow/" class="recent-link" data-astro-cid-zujyv34g> <span class="recent-title" data-astro-cid-zujyv34g>Apache Airflow Using Docker</span> <span class="recent-date" data-astro-cid-zujyv34g> <time datetime="2024-11-11T06:10:00.000Z">Nov 11, 2024</time> </span> </a> </li><li data-astro-cid-zujyv34g> <a href="/blog/2024-11-03/2024-11-03-fut-scrap/" class="recent-link" data-astro-cid-zujyv34g> <span class="recent-title" data-astro-cid-zujyv34g>Scrapping football data from optaplayerstats.statsperform.com</span> <span class="recent-date" data-astro-cid-zujyv34g> <time datetime="2024-11-03T06:10:00.000Z">Nov 3, 2024</time> </span> </a> </li> </ul> </div> <div class="sidebar-section" data-astro-cid-zujyv34g> <h3 data-astro-cid-zujyv34g>Trending Tags</h3> <div class="tag-cloud" data-astro-cid-zujyv34g> <a href="/tags/airflow/" class="tag-item" data-astro-cid-zujyv34g> Airflow </a><a href="/tags/streamlit/" class="tag-item" data-astro-cid-zujyv34g> Streamlit </a><a href="/tags/duckdb/" class="tag-item" data-astro-cid-zujyv34g> Duckdb </a><a href="/tags/aws/" class="tag-item" data-astro-cid-zujyv34g> AWS </a><a href="/tags/spotify/" class="tag-item" data-astro-cid-zujyv34g> Spotify </a><a href="/tags/selenium/" class="tag-item" data-astro-cid-zujyv34g> Selenium </a><a href="/tags/beautifulsoup4/" class="tag-item" data-astro-cid-zujyv34g> Beautifulsoup4 </a> </div> </div> </aside>  </aside> </div>  </main> <footer data-astro-cid-sz7xmlte>
&copy; 2026 Lucas Sobral. All rights reserved.
<p class="social-links" data-astro-cid-sz7xmlte> <a href="https://github.com/lucasbral" target="_blank" data-astro-cid-sz7xmlte>GitHub</a> <a href="https://www.linkedin.com/in/lucasbral" target="_blank" data-astro-cid-sz7xmlte>LinkedIn</a> </p> </footer>  </body></html> 